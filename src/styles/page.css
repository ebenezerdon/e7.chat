@reference "tailwindcss";

/* Layout */
.chat-container {
  @apply flex bg-gradient-to-br from-[#1a1e24] to-[#1e2329] text-white;
  height: 100vh; /* Fallback */
  height: 100dvh; /* Dynamic viewport height */
}

.chat-main {
  @apply flex-1 flex flex-col;
  position: relative;
  /* Important for proper mobile height calculation */
  height: 100vh;
  height: 100dvh;
}

.chat-header {
  @apply p-4 sm:p-8 border-b border-[#2c313a]/80 flex items-center justify-between bg-gradient-to-r from-[#1a1e24]/50 to-[#1e2329]/50;
}

.auth-controls {
  @apply flex items-center;
}

.auth-button {
  @apply bg-gradient-to-br from-blue-600 to-blue-700 hover:from-blue-500 hover:to-blue-600 text-white px-4 py-2 rounded-lg flex items-center gap-2 transition-all duration-200 text-sm font-medium shadow-md;
}

/* Mobile header adjustments */
@media (max-width: 640px) {
  .chat-header {
    @apply pl-16; /* Make room for the menu button */
  }
}

.title-group {
  @apply flex items-center gap-2;
}

.chat-title {
  @apply text-xl sm:text-2xl font-medium tracking-tight text-gray-100;
}

.creating-indicator {
  @apply text-sm text-blue-400 font-normal opacity-75;
  animation: pulse 1.5s ease-in-out infinite;
}

/* Message Container */
.message-container {
  @apply flex-1 overflow-y-auto py-6 sm:py-10 px-4 sm:px-10 bg-gradient-to-b from-[#1a1e24]/30 to-[#1e2329]/30;
}

.message-wrapper {
  @apply mb-6 sm:mb-8 flex items-start;
  animation: fadeIn 0.3s ease-out forwards;
}

@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translateY(8px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.message-content-wrapper {
  @apply flex-1 flex flex-col;
}

.message-content {
  @apply inline-block text-gray-200 p-3 sm:p-5 rounded-lg w-fit max-w-[95%] sm:max-w-[85%] text-[16px] sm:text-[17px] shadow-sm;
}

.message-sender {
  @apply text-gray-400 text-[15px] sm:text-[15px] mb-2 sm:mb-3 font-medium;
}

.saving-indicator {
  @apply ml-2 text-blue-400 text-xs opacity-70;
  animation: pulse 1.5s ease-in-out infinite;
}

@keyframes pulse {
  0%,
  100% {
    opacity: 0.4;
  }
  50% {
    opacity: 1;
  }
}

/* Avatars */
.user-avatar {
  @apply w-8 h-8 sm:w-12 sm:h-12 rounded-full mr-3 sm:mr-5 flex items-center justify-center bg-gradient-to-br from-blue-600 to-blue-700 flex-shrink-0 shadow-md;
}

.user-avatar-icon {
  @apply w-4 h-4 sm:w-6 sm:h-6 text-white;
}

.ai-avatar {
  @apply w-8 h-8 sm:w-12 sm:h-12 rounded-full mr-3 sm:mr-5 flex items-center justify-center bg-gradient-to-br from-purple-600 to-purple-700 flex-shrink-0 text-white text-sm sm:text-base font-bold shadow-md;
}

.ai-avatar-text {
  @apply text-white text-sm sm:text-base font-bold;
}

/* Message Backgrounds */
.user-message-bg {
  @apply bg-gradient-to-br from-[#2c313a]/80 to-[#2c313a]/60 border border-[#3a404b]/20;
}

.ai-message-bg {
  @apply bg-gradient-to-br from-[#343a46]/80 to-[#343a46]/60 border border-[#4a5061]/20;
}

/* Thinking Indicator */
.thinking-row {
  @apply flex items-center gap-1 px-2 sm:px-4 py-2;
}

.typing-indicator {
  @apply flex items-center gap-1 bg-gradient-to-r from-[#2c313a]/80 to-[#2c313a]/60 px-2 sm:px-3 py-1.5 sm:py-2 rounded-2xl border border-[#3a404b]/20;
}

.typing-indicator span {
  @apply w-1.5 h-1.5 sm:w-2 sm:h-2 rounded-full bg-gray-400;
  animation: bounce 1.4s infinite ease-in-out;
}

.typing-indicator span:nth-child(1) {
  animation-delay: -0.32s;
}

.typing-indicator span:nth-child(2) {
  animation-delay: -0.16s;
}

@keyframes bounce {
  0%,
  80%,
  100% {
    transform: scale(0);
    opacity: 0.3;
  }
  40% {
    transform: scale(1);
    opacity: 1;
  }
}

/* Input Area */
.input-area {
  @apply px-4 sm:pl-27 sm:pr-10 py-4 sm:py-6 border-t border-[#2c313a]/80 flex flex-col bg-gradient-to-r from-[#1a1e24]/70 to-[#1e2329]/70;
}

.input-form {
  @apply flex items-center gap-3 w-full max-w-5xl;
}

.input-field {
  @apply bg-gradient-to-r from-[#2c313a] to-[#2e333d] rounded-xl sm:rounded-2xl px-4 sm:px-8 py-3 sm:py-5 outline-none focus:ring-1 focus:ring-blue-500/70 focus:border-blue-500/50 transition-all text-[15px] sm:text-[17px] tracking-wide font-normal flex-1 h-12 sm:h-14 border border-[#3a404b]/30;
  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
}

.input-field:focus {
  box-shadow: 0 4px 20px rgba(59, 130, 246, 0.15);
}

.submit-button {
  @apply bg-gradient-to-br from-blue-600 to-blue-700 hover:from-blue-500 hover:to-blue-600 transition-all rounded-lg w-10 h-10 sm:w-12 sm:h-12 flex items-center justify-center disabled:opacity-50 ml-2 sm:ml-4 self-center shadow-md;
}

.submit-icon {
  @apply w-5 h-5 sm:w-6 sm:h-6 text-white;
}

/* States */
.empty-state {
  @apply flex items-center justify-center h-full text-gray-400 text-[15px] sm:text-[17px] font-medium tracking-wide px-4 text-center;
}

.loading-state {
  @apply flex items-center justify-center h-screen bg-gradient-to-br from-[#1a1e24] to-[#1e2329] text-white;
}

/* Delete Button */
.delete-button {
  @apply p-0.5 text-gray-400/80 hover:text-red-400 transition-colors rounded-full cursor-pointer;
}

.delete-icon {
  @apply w-4 h-4 sm:w-5 sm:h-5;
}

/* Input Mode Selector */
.input-mode-selector {
  @apply flex bg-[#2c313a]/50 rounded-lg p-1 mb-3 w-fit mx-auto border border-[#3a404b]/30;
}

.mode-button {
  @apply px-4 py-2 rounded-md text-sm font-medium transition-all duration-200 cursor-pointer;
}

.mode-button:not(.active) {
  @apply text-gray-400 hover:text-gray-200 hover:bg-[#3a404b]/30;
}

.mode-button.active {
  @apply bg-gradient-to-br from-blue-600 to-blue-700 text-white shadow-sm;
}

/* Image Generator */
.image-generator {
  @apply w-full max-w-5xl mx-auto;
}

.image-form {
  @apply w-full;
}

.image-input-wrapper {
  @apply flex items-center gap-3 bg-gradient-to-r from-[#2c313a] to-[#2e333d] rounded-xl sm:rounded-2xl p-3 sm:p-4 border border-[#3a404b]/30;
  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
}

.image-icon {
  @apply text-gray-400 flex-shrink-0;
}

.image-input {
  @apply bg-transparent outline-none text-[15px] sm:text-[17px] tracking-wide font-normal w-full text-gray-200 placeholder-gray-400;
}

.generate-button {
  @apply bg-gradient-to-br from-purple-600 to-purple-700 hover:from-purple-500 hover:to-purple-600 transition-all rounded-lg px-4 py-2 flex items-center gap-2 disabled:opacity-50 text-white text-sm font-medium shadow-md;
}

.loading-icon {
  animation: spin 1s linear infinite;
}

@keyframes spin {
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
}

.error-message {
  @apply mt-3 p-3 bg-red-500/10 border border-red-500/20 rounded-lg;
}

.error-message p {
  @apply text-red-400 text-sm;
}

/* Generated Image Display */
.generated-image-preview {
  @apply mt-4 p-4 bg-[#2c313a]/50 rounded-xl border border-[#3a404b]/30;
}

.generated-image-display {
  @apply mt-4 p-4 bg-[#2c313a]/30 rounded-lg border border-[#3a404b]/20;
}

.preview-image,
.chat-generated-image {
  @apply w-full max-w-md mx-auto rounded-lg shadow-lg border border-[#3a404b]/30;
}

.chat-generated-image {
  @apply max-w-sm;
}

.image-actions {
  @apply flex items-center justify-center gap-2 mt-3;
}

.download-button {
  @apply bg-[#3a404b]/50 hover:bg-[#3a404b]/70 transition-all duration-300 rounded-lg px-3 py-2 text-gray-200 text-sm border border-[#4a5061]/30 cursor-pointer relative overflow-hidden;
  min-width: 120px;
  min-height: 36px;
}

.download-button-content {
  @apply flex items-center justify-center gap-2 relative z-10;
}

.download-icon-container {
  @apply relative flex items-center justify-center;
  width: 16px;
  height: 16px;
}

.download-text {
  @apply transition-all duration-200;
  min-width: 80px;
  text-align: left;
}

.download-button.downloading {
  @apply bg-gradient-to-r from-blue-600/20 to-purple-600/20 border-blue-500/30;
  box-shadow: 0 0 20px rgba(59, 130, 246, 0.2);
  animation: downloadGlow 2s ease-in-out infinite alternate;
}

.download-button.success {
  @apply bg-gradient-to-r from-green-600/20 to-emerald-600/20 border-green-500/30;
  box-shadow: 0 0 20px rgba(34, 197, 94, 0.3);
}

.download-pulse {
  @apply absolute inset-0 bg-blue-500/30 rounded-full;
  animation: downloadPulse 1.5s ease-in-out infinite;
}

.download-bounce {
  animation: downloadBounce 1s ease-in-out infinite;
}

.download-success {
  @apply text-green-400;
  animation: downloadSuccess 0.5s ease-out;
}

.download-progress-container {
  @apply absolute bottom-0 left-0 right-0 h-1 bg-[#2a2f3a] overflow-hidden rounded-b-lg;
}

.download-progress-bar {
  @apply h-full bg-gradient-to-r from-blue-500 to-purple-500 transition-all duration-200 ease-out;
  box-shadow: 0 0 10px rgba(59, 130, 246, 0.5);
}

.download-button:disabled {
  @apply cursor-not-allowed;
}

.download-button:disabled:hover {
  @apply bg-[#3a404b]/50;
}

@keyframes downloadGlow {
  0% {
    box-shadow: 0 0 20px rgba(59, 130, 246, 0.2);
  }
  100% {
    box-shadow: 0 0 30px rgba(59, 130, 246, 0.4),
      0 0 40px rgba(147, 51, 234, 0.2);
  }
}

@keyframes downloadPulse {
  0% {
    transform: scale(0.8);
    opacity: 1;
  }
  100% {
    transform: scale(1.2);
    opacity: 0;
  }
}

@keyframes downloadBounce {
  0%,
  20%,
  50%,
  80%,
  100% {
    transform: translateY(0);
  }
  40% {
    transform: translateY(-3px);
  }
  60% {
    transform: translateY(-2px);
  }
}

@keyframes downloadSuccess {
  0% {
    transform: scale(0.5);
    opacity: 0;
  }
  50% {
    transform: scale(1.2);
  }
  100% {
    transform: scale(1);
    opacity: 1;
  }
}

.revised-prompt {
  @apply mt-3 text-gray-400 text-sm italic;
}

/* Mobile Specific */
@media (max-width: 640px) {
  html {
    height: -webkit-fill-available;
  }

  body {
    height: 100%;
  }

  .chat-container {
    overflow: hidden;
    /* Allow chat container to use full viewport */
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    height: 100vh; /* Standard height for most browsers */
    height: -webkit-fill-available; /* For iOS Safari */
    height: 100dvh; /* Dynamic viewport height when supported */
  }

  .chat-main {
    width: 100%;
    /* Main container fills the viewport */
    position: absolute;
    top: 0;
    bottom: 0;
    left: 0;
    right: 0;
    /* Explicitly set height to prevent layout shifts */
    height: 100%;
    display: flex;
    flex-direction: column;
    overflow: hidden;
  }

  .chat-header {
    flex-shrink: 0;
  }

  .message-container {
    flex: 1;
    overflow-y: auto;
    -webkit-overflow-scrolling: touch;
    padding: 1rem;
    padding-bottom: calc(4rem + env(safe-area-inset-bottom, 0));
    will-change: transform;
  }

  .input-area {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    padding: 0.75rem 1rem;
    background-image: linear-gradient(to right, #1a1e24, #1e2329);
    border-top: 1px solid #2c313a;
    padding-bottom: calc(0.75rem + env(safe-area-inset-bottom, 0));
    min-height: 60px;
    transform: translateZ(0);
    box-shadow: 0 -1px 10px rgba(0, 0, 0, 0.2);
  }

  .input-form {
    @apply w-full;
    height: 100%;
  }

  .message-content {
    @apply break-words leading-relaxed;
  }

  .markdown-content {
    @apply text-[16px] leading-relaxed;
  }

  .markdown-content pre {
    @apply max-w-[calc(100vw-3rem)] overflow-x-auto text-[14px];
  }

  .input-mode-selector {
    @apply mb-2;
  }

  .image-input-wrapper {
    @apply p-3;
  }

  .generate-button {
    @apply px-3 py-2 text-xs;
  }

  .chat-generated-image {
    @apply max-w-full;
  }
}

/* Loading Indicator */
.loading-indicator {
  @apply flex items-center gap-2 mt-2;
}

.loading-dots {
  @apply flex gap-1;
}

.loading-dots span {
  @apply w-2 h-2 bg-blue-500 rounded-full;
  animation: loadingPulse 1.4s ease-in-out infinite both;
}

.loading-dots span:nth-child(1) {
  animation-delay: -0.32s;
}

.loading-dots span:nth-child(2) {
  animation-delay: -0.16s;
}

@keyframes loadingPulse {
  0%,
  80%,
  100% {
    transform: scale(0);
    opacity: 0.5;
  }
  40% {
    transform: scale(1);
    opacity: 1;
  }
}

/* Model Selector Styles */
.model-selector-container {
  @apply relative;
}

.model-selector-pill {
  @apply flex items-center gap-1.5 px-3 py-2.5 bg-gradient-to-r from-[#2c313a] to-[#2e333d] text-gray-300 text-sm rounded-xl hover:from-[#343a46] hover:to-[#363b47] transition-all duration-200 cursor-pointer border border-[#3a404b]/30;
  height: 3rem; /* Match input field height */
  width: 140px; /* Fixed width */
  flex-shrink: 0; /* Don't shrink */
}

.model-selector-pill.loading {
  @apply opacity-60 cursor-not-allowed;
}

.model-display {
  @apply flex items-center gap-1 min-w-0 flex-1;
}

.model-name {
  @apply text-sm text-gray-300 font-normal truncate;
}

.featured-icon {
  @apply w-3 h-3 text-yellow-400 flex-shrink-0;
}

.chevron {
  @apply w-3 h-3 text-gray-400 transition-transform duration-200 flex-shrink-0;
}

.chevron.rotate {
  @apply rotate-180;
}

.model-dropdown {
  @apply absolute bottom-full left-0 mb-2 bg-[#2c313a] border border-[#3a404b] rounded-xl shadow-2xl z-50 min-w-[320px] max-w-[400px] max-h-[60vh] overflow-y-auto;
}

/* Featured Models Section */
.featured-section {
  @apply border-b border-[#3a404b]/50 pb-2 mb-2;
}

.section-header {
  @apply flex items-center gap-2 px-3 py-2 text-xs font-medium text-gray-400 uppercase tracking-wider;
}

.section-icon {
  @apply w-3 h-3;
}

.all-models-section {
  @apply pt-1;
}

/* Provider Groups */
.provider-group {
  @apply mb-2 last:mb-0;
}

.provider-name {
  @apply px-3 py-1.5 text-xs font-medium text-gray-400 uppercase tracking-wider border-b border-[#3a404b]/30;
}

/* Model Items */
.model-item {
  @apply w-full text-left px-3 py-2.5 hover:bg-[#343a46] transition-colors duration-150 border-none bg-transparent cursor-pointer;
}

.model-item.featured {
  @apply bg-gradient-to-r from-[#3a404b]/20 to-[#2c313a]/20 hover:from-[#3a404b]/30 hover:to-[#2c313a]/30;
}

.model-item.active {
  @apply bg-gradient-to-r from-blue-600/20 to-purple-600/20 text-blue-300;
}

.model-item.active.featured {
  @apply bg-gradient-to-r from-yellow-600/20 to-orange-600/20 text-yellow-300;
}

.model-info {
  @apply space-y-1;
}

.model-header {
  @apply flex items-center justify-between gap-2;
}

.model-title {
  @apply text-sm font-medium text-gray-200 flex items-center gap-1;
}

.featured-badge {
  @apply w-3 h-3 text-yellow-400;
}

.model-desc {
  @apply text-xs text-gray-400 block;
}

.model-pricing {
  @apply text-xs text-green-400 font-medium flex-shrink-0;
}

/* Scrollbar styling for the dropdown */
.model-dropdown::-webkit-scrollbar {
  @apply w-1;
}

.model-dropdown::-webkit-scrollbar-track {
  @apply bg-[#2c313a];
}

.model-dropdown::-webkit-scrollbar-thumb {
  @apply bg-[#3a404b] rounded-full;
}

.model-dropdown::-webkit-scrollbar-thumb:hover {
  @apply bg-[#4a5058];
}

/* Animation for dropdown */
.model-dropdown {
  animation: slideUp 0.15s ease-out;
}

@keyframes slideUp {
  from {
    opacity: 0;
    transform: translateY(8px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* Responsive adjustments */
@media (max-width: 640px) {
  .model-dropdown {
    @apply min-w-[280px] max-w-[90vw] left-0 right-0 mx-auto;
  }

  .model-selector-pill {
    @apply w-32;
  }
}

.input-form {
  display: flex;
  align-items: flex-end;
  gap: 8px;
  padding: 16px;
  background: var(--background-secondary);
  border-top: 1px solid var(--border);
  position: relative;
}
